# ğŸµ KKBox(ëŒ€ë§Œ ìŒì•… ìŠ¤íŠ¸ë¦¬ë° ì„œë¹„ìŠ¤) ì‚¬ìš©ì ì´íƒˆ ì˜ˆì¸¡ í”„ë¡œì íŠ¸
## Member
<table>
  <thead>
    <td align="center">
        <img src="./readme_img//git_img_jangsu.png" height="150" width="150" alt="jangsoo"/><br /><hr/>
        ê¹€ì¥ìˆ˜
      </a><br />
    </td>
    <td align="center">
        <img src="./readme_img//git_img_sunill.png" height="150" width="150" alt="Sungil"/><br /><hr/>
        ë°©ì„±ì¼
      </a><br />
    </td>
    <td align="center">
        <img src="https://github.com/user-attachments/assets/a28f14f0-2e04-4bb9-be4f-2fe81924e523" height="150" width="150" alt="jungsoo"/><br /><hr/>
        ë°°ì •ìˆ˜
      </a><br />
    </td>
    <td align="center">
      <a href="">
        <img src="./readme_img//git_img_hyeondae.png" height="150" width="150" alt="hyundae"/><br /><hr/>
        ì´í˜„ëŒ€
      </a><br />
    </td>
      <td align="center">
      <a href="https://github.com/minjung2266">
        <img src="https://github.com/minjung2266.png" height="150" width="150" alt="minjeong"/><br /><hr/>
        ì´ë¯¼ì •
      </a><br />
    </td>
  </thead>
</table>

---
### ğŸ“… ê°œë°œ ê¸°ê°„
**2025.03.31 ~ 2025.04.01 (ì´ 2ì¼)**

##  ğŸ¯ í”„ë¡œì íŠ¸ ê°œìš”

### **í”„ë¡œì íŠ¸ ëª©í‘œ**
- KKBox(ëŒ€ë§Œ ìŒì•… ìŠ¤íŠ¸ë¦¬ë° ì„œë¹„ìŠ¤) ì‚¬ìš©ìì˜ **ì´íƒˆ ì—¬ë¶€(is_churn)** ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ëª¨ë¸ì„ ê°œë°œí•˜ì—¬, KKBox ì‚¬ìš©ìì˜ ì´íƒˆ ë°©ì§€ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ìˆ˜í–‰í•˜ì—¬ ìˆ˜ìµ í–¥ìƒì— ê¸°ì—¬í•¨ì„ ëª©ì ìœ¼ë¡œ í•¨.

### **ê¸°ëŒ€íš¨ê³¼**:

 1. **ìˆ˜ìµ ì†ì‹¤ ë°©ì§€**  
   ì‹ ê·œ ê³ ê° í™•ë³´ ë¹„ìš©ì€ ê¸°ì¡´ ê³ ê°ì„ ìœ ì§€í•˜ëŠ” ë¹„ìš©ë³´ë‹¤ ë†’ìŒ. ë”°ë¼ì„œ ê¸°ì¡´ ê³ ê°ì˜ ì´íƒˆì„ ì¤„ì´ëŠ” ê²ƒì´ ë¹„ìš©ì ì¸ ë©´ì—ì„œ íš¨ìœ¨ì .

2. **ê³ ê° ì¶©ì„±ë„ í–¥ìƒ**  
   ê³ ê° ì´íƒˆ ê°€ëŠ¥ì„±ì´ ë†’ì€ ê³ ê°ì„ ì¡°ê¸°ì— ì‹ë³„í•˜ì—¬ ë§ì¶¤í˜• ìœ ì§€ ì „ëµì„ ì œê³µ -> ê³ ê° ì¶©ì„±ë„ë¥¼ ë†’ì—¬ ì¥ê¸°ì ìœ¼ë¡œ ë” ë†’ì€ ë§¤ì¶œ ì°½ì¶œì´ ê°€ëŠ¥

3. **ë¹„ì¦ˆë‹ˆìŠ¤ í”„ë¡œì„¸ìŠ¤ ê°œì„ **  
   ê³ ê° ì´íƒˆ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì—¬ ì œí’ˆ, ì„œë¹„ìŠ¤, ë˜ëŠ” ë§ˆì¼€íŒ… ì „ëµì—ì„œ ê°œì„ ì´ í•„ìš”í•œ ë¶€ë¶„ì„ íŒŒì•… ê°€ëŠ¥.

4. **ë§ˆì¼€íŒ… ë¦¬ì†ŒìŠ¤ ìµœì í™”**  
   ì´íƒˆ ê°€ëŠ¥ì„±ì´ ë†’ì€ ê³ ê°ì— ì§‘ì¤‘í•˜ì—¬ ê³ ê° ìœ ì§€ ì°¨ì›ì—ì„œ ë§ˆì¼€íŒ… ìì›ì„ íš¨ìœ¨ì ìœ¼ë¡œ ë°°ë¶„ ê°€ëŠ¥. ì´ëŠ” ê¸°ì—…ì˜ ROI(íˆ¬ì ëŒ€ë¹„ íš¨ê³¼) í–¥ìƒìœ¼ë¡œ ì—°ê²°ë¨.


### **ì ‘ê·¼ ë°©ì‹**:
  - ë°ì´í„°ë¥¼ ëª©ì ì— ë§ê²Œ ì „ì²˜ë¦¬ë¥¼ ì§„í–‰í•˜ê³  ì—¬ëŸ¬ ëª¨ë¸ ì¤‘ í•™ìŠµ í›„ ì„±ëŠ¥ì´ ì¢‹ì€ ëª¨ë¸ì„ ë°”íƒ•ìœ¼ë¡œ, ì´íƒˆ ì—¬ë¶€ì— í° ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” featureë“¤ì„ ì‹œê°í™”(ê·¸ë˜í”„ ë“±)ë¥¼ í†µí•´ í™•ì¸í•¨. ì´ë¥¼ í†µí•´ KKBoxì— ì œê³µí•  ìˆ˜ ìˆëŠ” ì¸ì‚¬ì´íŠ¸ë¥¼ ë„ì¶œ
   


## ğŸ“‚ë°ì´í„° êµ¬ì„±
### - ë°ì´í„°ì†ŒìŠ¤: [WSDM - KKBoxì˜ Churn Prediction Challenge](https://www.kaggle.com/c/kkbox-churn-prediction-challenge/overview)
#### [ DataSet : ì „ì²˜ë¦¬ ì „]

1. members_v3.csv (ìœ ì € í…Œì´ë¸”)
    - **ì„¤ëª…**: ìœ ì €ì˜ í”„ë¡œí•„ ì •ë³´
    - **ì»¬ëŸ¼**
        - `msno`: ìœ ì € ID
        - `city`: ë„ì‹œ
        - `bd`: ë‚˜ì´ 
        - `gender`: ì„±ë³„
        - `registered_via`: ê°€ì… ê²½ë¡œ
        - `registration_init_time`: ê°€ì… ë‚ ì§œ (`%Y%m%d`)
2. train_v2.csv / train1.csv
    - **ì„¤ëª…**: ìœ ì € IDì™€ ì´íƒˆ ì—¬ë¶€(`is_churn`)ê°€ í¬í•¨ëœ í•™ìŠµìš© ë°ì´í„°ì…‹ (2017ë…„ 2ì›”ê¹Œì§€ì˜ ë°ì´í„° ê¸°ë°˜)
    - **ì»¬ëŸ¼**
        - `msno`: ìœ ì € ID
        - `is_churn`: ì´íƒˆ ì—¬ë¶€ ('1' = ì´íƒˆ o, '0' = ì´íƒˆ x)
3.  transactions.csv / transactions_v2.csv 
    - **ì„¤ëª…**: ìœ ì €ì˜ **ê²°ì œ ì´ë ¥**ì´ ë‹´ê¸´ ë°ì´í„°ì…‹
    - **ì»¬ëŸ¼**
        - `msno`: ìœ ì € ID
        - `payment_method_id`: ê²°ì œ ë°©ì‹ ID x
        - `payment_plan_days`: í”Œëœ ê¸°ê°„ (ì¼ ê¸°ì¤€)   sum
        - `plan_list_price`: í”Œëœ ì •ê°€ (NTD)  mean/sum
        - `actual_amount_paid`: ì‹¤ì œ ê²°ì œ ê¸ˆì•¡ (NTD). mean/sum
        - discount_amout : í• ì¸ìœ¨ 1 - (actual_amount_pain / plan_list_price).  mean/sum
        - `is_auto_renew`: ìë™ ê°±ì‹  ì—¬ë¶€
        - `transaction_date`: ê²°ì œ ë‚ ì§œ (`%Y%m%d`)
        - `membership_expire_date`: íšŒì› ë§Œë£Œì¼ (`%Y%m%d`)
        - `is_cancel`: êµ¬ë… ì·¨ì†Œ ì—¬ë¶€


4.  user_logs.csv / user_logs_v2.csv
 

### TechSet
<p align="center">
  <img src="https://img.shields.io/badge/Python-3776AB?style=for-the-badge&logo=Python&logoColor=white">
  <img src="https://img.shields.io/badge/Visual%20Studio%20Code-0078d7.svg?style=for-the-badge&logo=vscode&logoColor=white">
  <img src="https://img.shields.io/badge/numpy-%235865F2.svg?style=for-the-badge&logo=numpy&logoColor=white">
</p>
<p align="center">
  <img src="https://img.shields.io/badge/pandas-%23000000.svg?style=for-the-badge&logo=pandas&logoColor=white">
  <img src="https://img.shields.io/badge/Matplotlib-%23ffffff.svg?style=for-the-badge&logo=Matplotlib&logoColor=black">
  <img src="https://img.shields.io/badge/scikit--learn-F7931E?style=for-the-badge&logo=scikit-learn&logoColor=white">
</p>
<br/><br/>

<hr>

### EDA
#### 1. ë°ì´í„° ì „ì²˜ë¦¬<br/>
![Image](https://github.com/user-attachments/assets/fe0b94b1-b6eb-49e7-aa27-33c52aac836d)
#### transaction_v2.csv ì— ëŒ€í•œ ì „ì²˜ë¦¬ ë‚´ìš©
### user_log ë°ì´í„° ì „ì²˜ë¦¬  
1. 28GBì˜€ë˜ ìœ ì € ë¡œê·¸ ë°ì´í„°ë¥¼ 1.1GB í¬ê¸°ì˜ 26ê°œ íŒŒì¼ë¡œ ë¶„ë¦¬  
2. member í…Œì´ë¸”ì„ ë¼ë²¨ì¸ì½”ë”©í•˜ì—¬ key-value í˜•íƒœì˜ JSONìœ¼ë¡œ ì €ì¥  
3. ë¶„ë¦¬ëœ íŒŒì¼ì˜ user_log ë°ì´í„°ë¥¼ `msno`ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë§¤í•‘  
4. ê° user_log ë‚´ ì¤‘ë³µë˜ëŠ” `userId`ë¥¼ Groupbyí•˜ì—¬ ì¤‘ë³µ ì œê±°  
   - ì´í›„, `use_date`(ë…¸ë˜ë¥¼ ë“¤ì€ ë‚ ì§œ), `start_date`(ì²˜ìŒ ë“¤ì€ ë‚ ), `end_date`(ë§ˆì§€ë§‰ ë“¤ì€ ë‚ ) ì»¬ëŸ¼ ì¶”ê°€  
5. ëª¨ë“  user_logë¥¼ í•˜ë‚˜ë¡œ í•©ì¹œ í›„ ë‹¤ì‹œ Groupbyí•˜ì—¬ 4ë²ˆê³¼ ë™ì¼í•œ ê³¼ì • ì§„í–‰  

### transaction ë°ì´í„° ì „ì²˜ë¦¬  
1. ê±°ë˜ ê¸°ë¡ ì´í›„ì˜ ì¶”ê°€ ê¸°ë¡ì´ í™•ì¸ë˜ì–´ ì´ìƒì¹˜ë¡œ íŒë‹¨ í›„ ì œê±°  
2. ìœ ì € ì •ë³´ ì¤‘ ì•„ì´ë””ê°€ ì—†ëŠ” ë°ì´í„° ì œê±°  
3. ê²°ì œì¼ì´ ë©¤ë²„ì‹­ ë§Œë£Œì¼ ì´í›„ì¸ ë°ì´í„° ì œê±°  

### members ë°ì´í„° ì „ì²˜ë¦¬  
1. `gender` ì»¬ëŸ¼ì˜ ê²°ì¸¡ì¹˜ê°€ 70% ì´ìƒìœ¼ë¡œ í™•ì¸ë˜ì–´ ì»¬ëŸ¼ ì œê±°  

<br/>
![Image](https://github.com/user-attachments/assets/8986b43f-0997-46bb-8ff8-6f33ffddd47b)
<br/>
bd(ë‚˜ì´) 10ì„¸ ì´ìƒ 80ì„¸ ì´í•˜ì¸ ë°ì´í„°ë§Œ ì¶”ì¶œ
    
ê²°ê³¼ : rrrr_final_data.csv ë°ì´í„° ê°œìˆ˜ : 839941 -> 275465<br/><br/><br/>

#### ì»¬ëŸ¼ ì¶”ê°€ ë° ì œê±° ì •ë¦¬
1. genderì˜ ê²°ì¸¡ì¹˜ê°€ 70% ì´ìƒ, ì»¬ëŸ¼ ì œê±°
2. end_date ì™€ start_date -> use_date ì»¬ëŸ¼ ì¶”ê°€
3. transaction_date ê°’ ì¤‘ max ê°’ì„ ì €ì¥ 
4. ê±°ë˜ íšŸìˆ˜ : transaction_count ì»¬ëŸ¼ ì¶”ê°€
5. is_cancel ì˜ ìˆ˜ : is_cancel_sum ì»¬ëŸ¼ ì¶”ê°€
6. is_cancel ì˜ í‰ê·  : is_cancel_mean ì»¬ëŸ¼ ì¶”ê°€
7. actual_amount_paidì˜ ì´í•© : actual_amount_paid_sum ì»¬ëŸ¼ ì¶”ê°€( 0ì¸ ê°’ ì œê±°)
8. is_auto_renew ì˜ í‰ê·  : is_auto_renew_mean ì»¬ëŸ¼ ì¶”ê°€
9. is_cancel == 0 ì¸ ë°ì´í„° í•„í„°ë§ -> plan_days_sum ì»¬ëŸ¼ ìƒì„±




### UnderSampling ì ìš© 
**ì˜¤ë²„ìƒ˜í”Œë§ì´ ì•„ë‹Œ ì–¸ë”ìƒ˜í”Œë§ ì ìš© ì´ìœ **
- ì´íƒˆ ì‚¬ìš©ìì˜ ë°ì´í„° ê°œìˆ˜ê°€ ì „ì²˜ë¦¬ í›„ 25612ê°œë¡œ ì¶©ë¶„í•˜ë‹¤ê³  íŒë‹¨
- ì˜¤ë²„ìƒ˜í”Œë§ì„ í•˜ë©° ì¸ìœ„ì ì¸ ë°ì´í„°ë¥¼ ë§Œë“œëŠ” ê²ƒë³´ë‹¤ ì›ë³¸ ë°ì´í„°ë¥¼ ìœ ì§€í•˜ë©° í•™ìŠµí•˜ëŠ” ê²ƒì´ ë” ì‹ ë¢°ë„ê°€ ìˆì„ ê²ƒì´ë¼ íŒë‹¨<br/><br/>
  
rrrr_final_data.csv ì˜ ë°ì´í„° ë¹„ìœ¨ì€ ì•„ë˜ì™€ ê°™ë‹¤. 
    
| is_churn | Count  |
|----------|--------|
| 0        | 249853 |
| 1        | 25612  |


ì•½ 10:1 ë¡œ, ë°ì´í„° ë¶ˆê· í˜•ì´ ìƒë‹¹í•˜ì—¬ 3:1ë¡œ ì¡°ì •í•˜ì—¬ ì–¸ë”ìƒ˜í”Œë§ì„ ì§„í–‰í–ˆë‹¤.<br/>
- íŒë‹¨ ê¸°ì¤€<br/>(https://www.dbpia.co.kr/journal/detail?nodeId=T15485105)<br/>(https://www.kci.go.kr/kciportal/ci/sereArticleSearch/ciSereArtiView.kci?sereArticleSearchBean.artiId=ART001273099)<br/>

-undersampling.py
  
| is_churn | Count  |
|----------|--------|
| 0        | 76836  |
| 1        | 25612  |


ê²°ê³¼ : undersampling_3_1_data.csv<br/><br/><br/>


-undersam_preprocessing.py<br/><br/>
'actual_amount_paid_sum'ì„ 'transaction_count'ë¡œ ë‚˜ëˆˆ ìƒˆë¡œìš´ ì»¬ëŸ¼ ì¶”ê°€
'payment_plan_days_sum'ì„ 'transaction_count'ë¡œ ë‚˜ëˆˆ ìƒˆë¡œìš´ ì»¬ëŸ¼ ì¶”ê°€

ê²°ê³¼ : 2_undersampling_3_1_data.csv<br/><br/><br/>

##### [ DataSet : ìµœì¢… ë°ì´í„°]
| ì»¬ëŸ¼ëª…                   | ì„¤ëª…                                                                |
|------------------------|---------------------------------------------------------------------------|
| `msno`                 | ì‚¬ìš©ì ê³ ìœ  ID                                                              |
| `is_churn`             | ì´íƒˆ ì—¬ë¶€ (1: ì´íƒˆ, 0: ìœ ì§€)                                                 |
| `city`                 | ì‚¬ìš©ìì˜ ë„ì‹œ (ì§€ì—­ ì •ë³´)                                                    |
| `bd`                   | ì‚¬ìš©ìì˜ ë‚˜ì´ (birth dateì—ì„œ ìœ ì¶”)                                          |
| `registered_via`       | ë“±ë¡ ê²½ë¡œ (ì•±, ì›¹, í˜ì´ìŠ¤ë¶ ë“±)                                              |
| `registration_init_time` | ê°€ì…í•œ ë‚ ì§œ (YYYYMMDD í˜•ì‹)                                                |
| `transaction_count`    | ì´ ê±°ë˜ íšŸìˆ˜                                                                 |
| `is_cancel_mean`       | í‰ê· ì ìœ¼ë¡œ ê±°ë˜ê°€ ì·¨ì†Œëœ ë¹„ìœ¨                                                 |
| `is_auto_renew_mean`   | ìë™ ê°±ì‹  ì—¬ë¶€ í‰ê·  (1: ìë™ ê°±ì‹ ë¨, 0: ì•„ë‹˜)                                 |
| `payment_plan_days_sum` | ì „ì²´ ê²°ì œ í”Œëœ ì¼ìˆ˜ í•©                                                       |
| `num_25`               | 25% ì •ë„ ê°ìƒí•œ ê³¡ ìˆ˜                                                         |
| `num_50`               | 50% ì •ë„ ê°ìƒí•œ ê³¡ ìˆ˜                                                         |
| `num_75`               | 75% ì •ë„ ê°ìƒí•œ ê³¡ ìˆ˜                                                         |
| `num_985`              | ê±°ì˜ ëê¹Œì§€ (98.5%) ê°ìƒí•œ ê³¡ ìˆ˜                                              |
| `num_100`              | 100% ê°ìƒí•œ ê³¡ ìˆ˜                                                             |
| `total_secs`           | ì „ì²´ ê°ìƒ ì‹œê°„(ì´ˆ ë‹¨ìœ„)                                                       |
| `use_date`             | í•´ë‹¹ ì‚¬ìš©ìì˜ ë°ì´í„°ê°€ ëª‡ ê°œì˜ ë‚ ì§œì— ê±¸ì³ ìˆëŠ”ì§€ (ì‚¬ìš©ì¼ ìˆ˜)                 |

### ë°ì´í„° ì‹œê°í™” 

![Image](https://github.com/user-attachments/assets/d37b851d-ea2d-4f75-b4f8-0e03c74b6549)


![Image](https://github.com/user-attachments/assets/8ed75916-2dec-4215-99db-9093384f7128)


![Image](https://github.com/user-attachments/assets/386f3e84-7fd4-4ff2-b51c-2e265e0ab0a0)


![Image](https://github.com/user-attachments/assets/d21f3aeb-8f0e-42e6-871d-b6f3da89a443)


![Image](https://github.com/user-attachments/assets/20bba289-9311-4002-834a-2dca5e4d5124)

     
---
### ì¸ê³µì§€ëŠ¥ í•™ìŠµ ê²°ê³¼

#### Model Performance (Before & After Tuning)

| Model               | Accuracy (Before â†’ After) | Precision (Before â†’ After) | Recall (Before â†’ After) | F1 Score (Before â†’ After) | ROC AUC (Before â†’ After) |
|--------------------|---------------------|----------------------|----------------|-----------------|----------------|
| **LogisticRegression** | 0.8319 â†’ 0.8320  | 0.6814 â†’ 0.6815  | 0.6140 â†’ 0.6142 | 0.6459 â†’ 0.6461  | 0.8739 â†’ 0.8743 |
| **RandomForest**      | 0.8601 â†’ 0.9618  | 0.7606 â†’ 0.9811  | 0.6416 â†’ 0.8638 | 0.6960 â†’ 0.9187  | 0.9190 â†’ 0.9896 |
| **XGBoost**           | 0.8623 â†’ 0.8907  | 0.7565 â†’ 0.8243  | 0.6613 â†’ 0.7145 | 0.7057 â†’ 0.7655  | 0.9225 â†’ 0.9460 |
| **LightGBM**          | 0.8636 â†’ 0.8808  | 0.7794 â†’ 0.8180  | 0.6329 â†’ 0.6721 | 0.6985 â†’ 0.7379  | 0.9237 â†’ 0.9388 |


#### íŠœë‹ í›„ ëª¨ë¸ë³„ ì„±ëŠ¥ ë¹„êµ
![Image](https://github.com/user-attachments/assets/fca649a4-26c2-49ed-9b8f-11068556577e)
#### íŠœë‹ í›„ ROC - CURVE
![Image](https://github.com/user-attachments/assets/798780aa-350f-4db3-9e91-d3b3eae4b690)
#### ëª¨ë¸ ë³„ ì˜ˆì¸¡ ë°ì´í„° ìˆ˜ 
![Image](https://github.com/user-attachments/assets/181a7dc1-1ef8-453d-942f-55833b46a0f1) 

- í‰ê°€ì§€í‘œ, ROC - CURVE ì˜ ê²°ê³¼ë¥¼ í† ëŒ€ë¡œ ìµœì¢… ëª¨ë¸ì„ **RandomForest**ë¡œ ì„ ì •

#### íŠ¹ì„± ì¤‘ìš”ë„ 
![Image](https://github.com/user-attachments/assets/c8f43974-9b86-41ba-b922-53192a6fec95)


---
### Insights ë° ê²°ë¡ 

---
### í•œ ì¤„ íšŒê³ 

| íŒ€ì›  | í•œ ì¤„ íšŒê³                  |
|-------|----------------------------|
| ì •ìˆ˜  |  |
| í˜„ëŒ€  |  |
| ì„±ì¼  |  |
| ì¥ìˆ˜  |  |
| ë¯¼ì •  |  |
  
